(function(t){if(typeof t.delegate=="undefined"){t.delegate=function(t,i){return function(){return t.apply(i,arguments)}}}t.Date.now=t.Date.now||function(){return(new Date).getTime()};if(typeof t.console=="undefined")t.console={};if(typeof t.console.log!="function")t.console.log=function(t){};(function(t){var i=0;var e=["ms","moz","webkit","o"];for(var n=0;n<e.length&&!t.requestAnimationFrame;++n){t.requestAnimationFrame=t[e[n]+"RequestAnimationFrame"];t.cancelAnimationFrame=t[e[n]+"CancelAnimationFrame"]||t[e[n]+"CancelRequestAnimationFrame"]}if(t.requestAnimationFrame===undefined){t.requestAnimationFrame=function(e,n){var o=Date.now(),a=Math.max(0,16-(o-i));var s=t.setTimeout(function(){e(o+a)},a);i=o+a;return s}}t.cancelAnimationFrame=t.cancelAnimationFrame||function(i){t.clearTimeout(i)}})(t)})(this);(function(t){var i=t.mf=t.mf||{};i.utils=i.utils||{};function e(){}i.utils.Maths=e;e.easeLinear=function(t,i,e,n){return i+e*(t/n)};e.easeOutQuad=function(t,i,e,n){t=t/n;return-e*t*(t-2)+i};e.easeOutElastic=function(t,i,e,n,o,a){if(t==0){return i}t=t/n;if(t==1){return i+e}var s=0;if(a!=0){a=n*.3}if(o<Math.abs(e)){o=e;s=a/4}else{s=a/(2*Math.PI)*Math.asin(e/o)}return o*Math.pow(2,-10*t)*Math.sin((t*n-s)*(2*Math.PI)/a)+e+i};e.bezierLinear=function(t,e,n){var o=1-t;var a=o*e.x+t*n.x;var s=o*e.y+t*n.y;return new i.geom.Vector2D(a,s)};e.bezierQuad=function(t,e,n,o){var a=1-t;var s=a*a*e.x+2*a*t*n.x+t*t*o.x;var r=a*a*e.y+2*a*t*n.y+t*t*o.y;return new i.geom.Vector2D(s,r)};e.bezierCubic=function(t,e,n,o,a){var s=1-t;var r=s*s*s*e.x+3*s*s*t*n.x+3*s*t*t*o.x+t*t*t*a.x;var h=s*s*s*e.y+3*s*s*t*n.y+3*s*t*t*o.y+t*t*t*a.y;return new i.geom.Vector2D(r,h)};e.bezierCasteljau=function(t,e){var n,o;if(e.length==1){e=e[0]}var a=[];for(n=0;n<e.length;n++){a.push(new i.geom.Vector2D(e[n].x,e[n].y))}for(n=1;n<e.length;n++){for(o=0;o<e.length-n;o++){a[o].x=(1-t)*a[o].x+t*a[o+1].x;a[o].y=(1-t)*a[o].y+t*a[o+1].y}}return a[0]};e.geoDistance=function(t,i,e,n,o){if(typeof o=="undefined")o=6378137;t*=Math.PI/180;i*=Math.PI/180;e*=Math.PI/180;n*=Math.PI/180;var a=Math.cos(t)*Math.cos(e)*Math.cos(i)*Math.cos(n)+Math.cos(t)*Math.sin(i)*Math.cos(e)*Math.sin(n)+Math.sin(t)*Math.sin(e);var s=Math.acos(a);if(isNaN(s)){s=0}return o*s}})(this);(function(t){var i=t.mf=t.mf||{};i.dom=i.dom||{};function e(){}i.dom.Viewport=e;e.isInViewport=function(t){var i=t.getBoundingClientRect();var e=document.documentElement;return i.top>=0&&i.left>=0&&i.bottom<=(window.innerHeight||e.clientHeight)&&i.right<=(window.innerWidth||e.clientWidth)}})(this);(function(t,i){var e=t.mf=t.mf||{};e.animation=e.animation||{};function n(t){this.options=i.extend({length:1},t);this.time=0;this.length=this.options.length;this.easing={easingFunction:e.utils.Maths.easeOutQuad,startTime:0,duration:0,startValue:0,endValue:0,on:false}}e.animation.TimeLine=n;n.TIME_CHANGED="eventTimeChanged";n.PLAY="eventPlay";n.STOP="eventStop";n.prototype.ease=function(){if(this.easing.on){var t=Date.now()-this.easing.startTime;var i=this.easing.duration;if(t>=i){this.easing.on=false;this.setTime(this.easing.endValue)}else{this.setTime(this.easing.easingFunction(t,this.easing.startValue,this.easing.endValue-this.easing.startValue,i));requestAnimationFrame(delegate(this.ease,this))}}};n.prototype.moveToTime=function(t,n){n=i.extend({duration:Math.min(1e3,Math.abs(t-this.time)),easing:e.utils.Maths.easeOutQuad},n);this.easing.startTime=Date.now();this.easing.duration=n.duration;this.easing.startValue=this.time;this.easing.endValue=t;this.easing.easingFunction=n.easing;if(!this.easing.on){this.easing.on=true;requestAnimationFrame(delegate(this.ease,this))}};n.prototype.setTime=function(t){if(t!=this.time){this.time=t;i(this).trigger(n.TIME_CHANGED)}};n.prototype.play=function(){i(this).trigger(n.PLAY);this.moveToTime(this.length,{duration:this.length-this.time,easing:e.utils.Maths.easeLinear})};n.prototype.stop=function(t){if(typeof t!="undefined"){this.setTime(t)}i(this).trigger(n.STOP);this.easing.on=false}})(this,jQuery);(function(t,i){var e=t.mf=t.mf||{};e.animation=e.animation||{};function n(t){delegate(e.animation.TimeLine,this)(t);this.options=i.extend({touchEnabled:false,touchHeight:700,height:5e3,minScrollGap:3},this.options);this.time=0;this.length=this.options.length;this.options.touchEnabled=this.options.touchEnabled&&"ontouchstart"in document.documentElement;this.touch={};if(this.options.touchEnabled){console.log("Scrollline touch");document.addEventListener("touchstart",delegate(this.onTouchStart,this));document.addEventListener("touchmove",delegate(this.onTouchMove,this));document.addEventListener("touchend",delegate(this.onTouchEnd,this))}else{console.log("Scrollline scroll "+this.options.height);i("body").height(this.options.height);i(window).scroll(delegate(this.onScroll,this))}}e.animation.ScrollLine=n;n.prototype=new e.animation.TimeLine;n.prototype.moveToTime=function(t,n){n=i.extend({moveScrollbar:true},n);delegate(e.animation.TimeLine.prototype.moveToTime,this)(t,n);if(n.moveScrollbar&&t!=this.time){this.updateScrollbar(t)}};n.prototype.updateScrollbar=function(t){var e=window.innerHeight||document.documentElement.clientHeight;i(window).scrollTop(Math.ceil((this.options.height-e)*(t/this.length)))};n.prototype.play=function(){i(this).trigger(e.animation.TimeLine.PLAY);this.moveToTime(this.length,{duration:this.length-this.time,easing:e.utils.Maths.easeLinear,moveScrollbar:false})};n.prototype.onScroll=function(){var t=window.innerHeight||document.documentElement.clientHeight;var e=Math.round(this.length*i(window).scrollTop()/(this.options.height-t));if(Math.abs(e-this.time)<=this.options.minScrollGap){return}this.moveToTime(e,{moveToTime:false})};n.prototype.onTouchStart=function(t){t.preventDefault();t.stopImmediatePropagation();this.touch.startY=t.touches[0].pageY;this.touch.startTime=this.time};n.prototype.onTouchMove=function(t){t.preventDefault();t.stopImmediatePropagation();var i=t.touches[0].pageY;this.touch.lastDY=i-this.touch.lastY;this.touch.lastY=i;var e=i-this.touch.startY;var n=Math.max(0,Math.min(this.length,Math.round(this.touch.startTime+this.length*(-e/this.options.touchHeight))));this.setTime(n,false)};n.prototype.onTouchEnd=function(t){if(Math.abs(this.touch.lastDY)>this.options.minScrollGap){var i=Math.max(0,Math.min(this.length,Math.round(this.time+this.length*(-10*this.touch.lastDY/this.options.touchHeight))));this.moveToTime(i,false)}}})(this,jQuery);(function(t,i){var e=t.mf=t.mf||{};e.animation=e.animation||{};function n(){this.length=0;this.animations=[]}e.animation.Sequencer=n;n.prototype.register=function(t){t=i.extend({start:this.length,duration:100,animate:undefined,animateIn:undefined,animateOut:undefined,started:false},t);this.animations.push(t);this.length=Math.max(this.length,t.start+t.duration);return t};n.prototype.process=function(t){var i,e;for(var n=0,o=this.animations.length;n<o;n++){e=this.animations[n];i=t-e.start;if(e.started&&(i<0||i>=e.duration)){if(typeof e.animateOut=="function"){e.animateOut(i,e.duration)}e.started=false}}for(var n=0,o=this.animations.length;n<o;n++){e=this.animations[n];i=t-e.start;if(!e.started&&i>=0&&i<e.duration){if(typeof e.animateIn=="function"){e.animateIn(i,e.duration)}e.started=true}}for(var n=0,o=this.animations.length;n<o;n++){e=this.animations[n];i=t-e.start;if(i>=0&&i<e.duration){if(typeof e.animate=="function"){e.animate(i,e.duration)}}}}})(this,jQuery);(function(t){var i=t.mf=t.mf||{};i.geom=i.geom||{};function e(t,i){this.x=t;this.y=i}i.geom.Vector2D=e;var n=e.prototype;n.addVector=function(t){return new e(this.x+t.x,this.y+t.y)};e.prototype.substractVector=function(t){return new e(this.x-t.x,this.y-t.y)};e.prototype.multiply=function(t){return new e(t*this.x,t*this.y)};e.prototype.norm=function(){return Math.sqrt(this.norm2())};e.prototype.norm2=function(){return this.x*this.x+this.y*this.y};e.prototype.scalarProduct=function(t){return this.x*t.x+this.y*t.y};e.prototype.dotProduct=function(t){return this.x*t.y-this.y*t.x};e.intersection=function(t,i,n,o){return t.addVector(i.multiply(e.intersectionRatio(t,i,n,o)))};e.intersectionRatio=function(t,i,e,n){return e.substractVector(t).dotProduct(n)/i.dotProduct(n)};e.projection=function(t,i,n){return i.addVector(n.multiply(e.projectionRatio(t,i,n)))};e.projectionRatio=function(t,i,e){return e.scalarProduct(t.substractVector(i))/e.norm2()};e.intersectPoly=function(t,i,n){var o=[];var a=[];var s=[];var r=0;for(var h=0;h<n.length;h++){var u=n[h];var c=n[(h+1)%n.length];var m=c.substractVector(u);switch(r){case 0:case 2:o.push(u);break;case 1:a.push(u);break}var l=e.intersectionRatio(u,m,t,i);if(l>=0&&l<1&&r<2){r++;var f=u.addVector(m.multiply(l));s.push(f);o.push(f);a.push(f)}}return{intersections:s,polyIn:o,polyOut:a}}})(this);(function(t){var i=t.mf=t.mf||{};i.geom=i.geom||{};i.geom.projections=i.geom.projections||{};var e=function(t,i,e){this.w=e;this.x0=t;this.y0=i;this.setPhi0(45)};i.geom.projections.GallCalculator=e;e.prototype.setPhi0=function(t){this.phi0=t;this.cosphi0=Math.cos(this.phi0*(Math.PI/180));this.r=180/Math.PI*(this.w/360)/this.cosphi0};e.prototype.getXY=function(t,i){var e=this.x0+i*(Math.PI/180)*this.r*this.cosphi0;var n=this.y0-this.r*(1+this.cosphi0)*Math.tan(t*(Math.PI/180)/2);return{x:e,y:n,lat:t,lng:i}};e.prototype.getLatLng=function(t,i){var e=360/this.w*(t-this.x0);var n=180/Math.PI*2*Math.atan((this.y0-i)/(this.r*(1+this.cosphi0)));return{x:t,y:i,lat:n,lng:e}}})(this);(function(t){var i=t.mf=t.mf||{};i.geom=i.geom||{};i.geom.projections=i.geom.projections||{};var e=function(t,i,e){this.w=e;this.x0=t;this.y0=i};i.geom.projections.MercatorCalculator=e;e.prototype.getXY=function(t,i){var e=this.x0+this.w*i/360;var n=this.y0-this.w/(2*Math.PI)*Math.log(Math.tan(Math.PI/4+t*(Math.PI/180)/2));return{x:e,y:n,lat:t,lng:i}};e.prototype.getLatLng=function(t,i){var e=360/this.w*(t-this.x0);var n=180/Math.PI*(2*Math.atan(Math.exp((this.y0-i)*(2*Math.PI)/this.w))-Math.PI/2);return{x:t,y:i,lat:n,lng:e}}})(this);(function(t){var i=t.mf=t.mf||{};i.utils=i.utils||{};function e(t,i,e){if(typeof e==="undefined"){e="0"}while(t.length<i){t=e+t}return t}function n(t,i,e){this.r=Math.max(0,Math.min(255,Math.round(t)));this.g=Math.max(0,Math.min(255,Math.round(i)));this.b=Math.max(0,Math.min(255,Math.round(e)))}i.utils.Color=n;n.prototype.toHTML=function(){return"#"+e(this.r.toString(16),2)+e(this.g.toString(16),2)+e(this.b.toString(16),2)};n.prototype.desaturate=function(t){var i=.3086;var e=.6094;var o=.082;var a=(1-t+t*i)*this.r+t*e*this.g+t*o*this.b;var s=t*i*this.r+(1-t+t*e)*this.g+t*o*this.b;var r=t*i*this.r+t*e*this.g+(1-t+t*o)*this.b;return new n(a,s,r)};n.hsb=function(t,i,e){var o=0,a=0,s=0;t=t%360;i/=100;e/=100;t/=60;var r=Math.floor(t);var h=t-r;var u=e*(1-i);var c=e*(1-i*h);var m=e*(1-i*(1-h));if(r==0){o=e;a=m;s=u}else if(r==1){o=c;a=e;s=u}else if(r==2){o=u;a=e;s=m}else if(r==3){o=u;a=c;s=e}else if(r==4){o=m;a=u;s=e}else if(r==5){o=e;a=u;s=c}o=Math.floor(o*255);a=Math.floor(a*255);s=Math.floor(s*255);return new n(o,a,s)};n.prototype.getNBTransform=n.prototype.desaturate})(this);